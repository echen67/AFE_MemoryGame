<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Upload</title>

    <script type="text/javascript">
    // singular file uploads
        function selectFile() {
            var file = document.getElementById('list').files[0];
            var textType = /text.*/;
            if(!file.type.match(textType)) {
                alert('Please select a word list saved as a .txt file.');
            } else {
                var s = 'Name: ' + file.name;
                s += '<br>Type: ' + file.type;
                s += '<br>Size: ' + file.size;
                file.openFile(event);
                s += "<br>====================================<br>"
                document.getElementById('fileDetails').innerHTML = s;
            }
        }

        // multiple file uploads
        function selectFiles() {
            var fileUps = document.getElementById('lists').files;
            var s = 'Number of files: ' + fileUps.length + '<br>';
            for (i =0; i < fileUps.length; i++) {
                var file = fileUps[i];
                var textType = /text.*/;
                if(!file.type.match(textType)) {
                    alert(file.name + ' is not a valid file type. Please select a word list saved as a .txt file.');
                } else {
                    s += 'Name: ' + file.name;
                    s += '<br>Type: ' + file.type;
                    s += '<br>Size: ' + file.size;
                    s += "<br>===================================="
                }
            }
            document.getElementById('fileDetails').innerHTML = s;
        }

        var openFile = function(event) {
            // ERROR Prevention: Check for the various File API support.
            if (window.File && window.FileReader && window.FileList && window.Blob) {
                // Great success! All the File APIs are supported.
                var input = event.target;
                var reader = new FileReader();
                reader.onload = function(){
                  var text = reader.result; // contains all textual content from file
                  var node = document.getElementById('output'); // sets the node to the div 'output'
                  node.innerText = text; // displays the text to the HTML in the div 'output'
                  console.log(reader.result.substring(0, 200));
                };
                reader.readAsText(input.files[0]);
            } else {
              alert('The File APIs are not fully supported in this browser.');
            }

        };

        // ---------------------------------------- BUTTON NAVIGATION
        function upload(){
            // insert LocalStorage code
            window.location.href = "home.html";
        }
        function back(){
            window.location.href = "home.html";
        }
        function help(){
            window.location.href = "help.html";
        }
        function makeCustomList(){
            window.location.href = "addWord.html";
        }
    </script>
</head>

<body>
    <h3>Word Find</h3>
    <button onclick = "makeCustomList()">Make Custom List</button>
    <br>
    <h4>Create New Word List: Upload File</h4>
    <form>
        List Display Name:  <input type = "text" id = "displayN" value = "">
        <br>
        <br>
        File Select:  <input type = "file" accept = 'text/plain' id = "uploadFile" onchange='openFile(event)'>
    </form>
    <!-- BUTTONS -->
    <p>Add File</p> <!-- TODO: multiple file uploads -->
    <button onclick = "upload()">UPLOAD</button>
    <br>
    <button onclick = "back()">Back</button>
    <br>
    <button onclick = "help()">Help</button>
    <div id='output'>
        ...
    </div>
</body>
</html>